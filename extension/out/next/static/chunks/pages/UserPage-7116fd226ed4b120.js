(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{7187:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/UserPage",function(){return t(9642)}])},9642:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return F}});var r=t(1799),o=t(9396),a=t(9534),i=t(828),s=t(5893),l=t(7294),c=t(7314),u=t(2097),d=t(5050),f=t(2722),p=t(8661),h=t(9630),x=t(1953),j=t(6837),m=t(9815),b=t(9072),Z=t(5214),g=t(3265),v=t(562),y=t(9594),I=t(4731),w=t(4548),C=t(1733),_=t(754),S=t(5155);var O=function(e){var n=e.user,t=(0,l.useState)(null),r=t[0],o=t[1],a=(0,l.useState)(!1),i=a[0],c=a[1],u=(0,l.useState)([1]),d=u[0],f=u[1];return(0,l.useEffect)((function(){return j.O.storage.from("documents").list("".concat(n.id),{sortBy:{column:"created_at",order:"desc"}}).then((function(e){j.O.from("users").select("job_position, jobMailInfo").match({user_id:n.id}).order("id",{ascending:!1}).then((function(t){if(0===e.data.length)return o([]);e.data.map((function(e,r){var o=j.O.storage.from("documents").getPublicUrl("".concat(n.id,"/").concat(e.name)),a=o.publicURL;o.error;e.url=a,t.data.length>0&&(e.title=t.data[r].job_position,e.type=t.data[r].jobMailInfo.fileType)})),t.data.length>0&&o(e.data),i&&o(e.data),console.log("render",e.data)}))})).catch((function(e){return console.log(e)})),function(){!1}}),[i]),(0,s.jsxs)(b.ZP,{textAlign:"center",item:!0,xs:12,md:6,children:[(0,s.jsx)(Z.Z,{dense:!0,children:r?r.map((function(e){return(0,s.jsxs)(g.ZP,{secondaryAction:(0,s.jsx)(v.Z,{edge:"end",onClick:function(){return function(e){c(!0);var t=d.indexOf(e),r=(0,m.Z)(d);-1===t&&r.push(e),f(r),j.O.storage.from("documents").remove(["".concat(n.id,"/").concat(e.name)]).then((function(t){j.O.from("users").delete().match({user_id:n.id,job_position:e.title}).then((function(e){console.log(e.status),c(!1)})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}(e)},"aria-label":"delete",children:i&&-1!==d.indexOf(e)?(0,s.jsx)(_.Z,{size:20}):(0,s.jsx)(C.Z,{})}),children:[(0,s.jsx)(y.Z,{children:(0,s.jsx)(I.Z,{children:"pdf"===e.type?(0,s.jsx)(S.cdp,{className:"pdfIcon"}):(0,s.jsx)(S.Mk3,{className:"wordIcon"})})}),(0,s.jsx)(w.Z,{primary:"".concat(e.title),secondary:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",href:e.url,children:"".concat(e.name)})})})]},e.id)})):(0,s.jsx)(_.Z,{thickness:2})}),r&&0===r.length&&(0,s.jsx)(h.Z,{variant:"p",children:"Your CVs are empty."})]})},E=t(7568),k=t(4051),M=t.n(k),P=t(2958),N=t(1520),T=t(5084),A=t(6307);t(1045);var V=function(e){var n=e.user,t=(0,l.useState)([]),a=t[0],i=t[1],c=(0,l.useState)([]),u=c[0],d=(c[1],(0,l.useState)([])),f=d[0],p=d[1],h=(0,l.useState)(!1),m=h[0],b=h[1],Z=(0,l.useState)(""),g=(Z[0],Z[1]),v=(0,l.useState)(""),y=v[0],I=v[1],w={options:a,getOptionLabel:function(e){return e.title},isOptionEqualToValue:function(e,n){return e.title===n.title}},C={options:u,getOptionLabel:function(e){return e.title},isOptionEqualToValue:function(e,n){return e.title===n.title}};(0,l.useEffect)((function(){n&&(j.O.from("users").select("job_position").eq("user_id",n.id).then((function(e){return i(e.data.map((function(e){return{title:e.job_position}})))})),console.log(a))}),[]);var O=(0,l.useCallback)((function(e){b(!0),j.O.from("users").select("*").single().match({user_id:n.id,job_position:e}).then((function(e){p(e.data),b(!1)})),console.log(f)}),[f]);function k(){return(k=(0,E.Z)(M().mark((function e(n){var t,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,j.O.auth.session();case 3:return t=e.sent,console.log(t),console.log(f),f.jobMailInfo,e.next=9,V(y);case 9:r=e.sent,console.log("result",r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return L.apply(this,arguments)}function L(){return L=(0,E.Z)(M().mark((function e(n){var t,r;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("api/verifyEmail",{method:"post",body:JSON.stringify({to:n}),headers:{"Content-Type":"application/json"}});case 3:return t=e.sent,e.next=6,t.json();case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),L.apply(this,arguments)}return(0,s.jsxs)(x.Z,{component:"form",onSubmit:function(e){return k.apply(this,arguments)},sx:{"& > :not(style)":{m:1,width:"25ch"},textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},noValidate:!0,autoComplete:"off",children:[(0,s.jsx)(P.Z,{onChange:function(e){return I(e.target.value)},id:"standard-basic",label:"Job Email",type:"email",variant:"standard"}),(0,s.jsx)(N.Z,(0,o.Z)((0,r.Z)({},w),{disableClearable:!0,fullWidth:!0,id:"auto-complete",autoComplete:!0,includeInputInList:!0,onChange:function(e){return n=e.target.innerText,void O(n);var n},renderInput:function(e){return(0,s.jsx)(P.Z,(0,o.Z)((0,r.Z)({},e),{label:"Job Position",variant:"standard"}))}})),(0,s.jsx)(N.Z,(0,o.Z)((0,r.Z)({},C),{disableClearable:!0,fullWidth:!0,autoComplete:!0,value:{title:f.jobMailInfo?f.jobMailInfo.jobEmailSubject:""},includeInputInList:!0,renderInput:function(e){return(0,s.jsx)(P.Z,(0,o.Z)((0,r.Z)({},e),{label:"Email Subject",variant:"standard",InputProps:(0,o.Z)((0,r.Z)({},e.InputProps),{endAdornment:(0,s.jsxs)(l.Fragment,{children:[m?(0,s.jsx)(_.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}})),(0,s.jsx)(P.Z,{id:"outlined-textarea",label:"notes...",placeholder:"notes...",onChange:function(e){return g(e.target.value)},multiline:!0}),f.jobMailInfo?"pdf"===f.jobMailInfo.fileType?(0,s.jsx)(S.cdp,{className:"pdfIcon"}):(0,s.jsx)(S.Mk3,{className:"wordIcon"}):"",m?(0,s.jsx)(_.Z,{color:"inherit",size:20}):f.jobMailInfo?f.jobMailInfo.fileName:"",(0,s.jsx)(T.Z,{type:"submit",variant:"contained",endIcon:(0,s.jsx)(A.Z,{}),children:"Send"})]})},L=t(4900),D=t(6540);var R=function(e){var n=e.user,t=(0,l.useState)(""),r=t[0],o=t[1],a=(0,l.useState)(""),i=a[0],c=a[1],u=(0,l.useState)(null),d=u[0],f=u[1];function p(){return p=(0,E.Z)(M().mark((function e(){var t,o,a;return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(d);case 2:return t=e.sent,e.next=5,j.O.from("users").insert([{user_id:n.id,job_position:r,jobMailInfo:{jobEmailSubject:i,file:t,fileType:d.name.split(".").pop(),fileName:d.name}}]);case 5:o=e.sent,a=o.data,o.error,console.log(a);case 9:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}var m=function(e){return new Promise((function(n,t){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return n(r.result)},r.onerror=function(e){return t(e)}}))};return(0,s.jsxs)(x.Z,{component:"form",onSubmit:function(e){e.preventDefault(),j.O.storage.from("documents").upload("".concat(n.id,"/").concat(d.name),d).then((function(e){if(!e.data)throw console.log(e),new Error("something wrong with your file!");!function(){p.apply(this,arguments)}(),f(null),o(""),c("")})).catch((function(e){return console.log(e)}))},sx:{"& > :not(style)":{m:1},textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},noValidate:!0,autoComplete:"off",children:[(0,s.jsx)(P.Z,{value:r,onChange:function(e){return o(e.target.value)},id:"standard-basic",label:"job position",variant:"standard"}),(0,s.jsx)(P.Z,{value:i,onChange:function(e){return c(e.target.value)},id:"standard-basic",label:"job Email Subject",variant:"standard"}),(0,s.jsxs)(v.Z,{color:"primary","aria-label":"upload picture",component:"label",children:[(0,s.jsx)("input",{onChange:function(e){return f(e.target.files[0])},hidden:!0,accept:".doc,.docx,.pdf",type:"file"}),(0,s.jsx)(L.Z,{})]}),(0,s.jsx)(h.Z,{variant:"p",children:d&&d.name}),(0,s.jsx)(T.Z,{variant:"contained",disabled:function(e,n){return""===e||!n||""===i}(r,d),type:"submit",endIcon:(0,s.jsx)(D.Z,{}),children:"Add"})]})},U=t(1163);function q(e){var n=e.children,t=e.value,i=e.index,l=(0,a.Z)(e,["children","value","index"]);return(0,s.jsx)("div",(0,o.Z)((0,r.Z)({role:"tabpanel",hidden:t!==i,id:"full-width-tabpanel-".concat(i),"aria-labelledby":"full-width-tab-".concat(i)},l),{children:t===i&&(0,s.jsx)(x.Z,{sx:{p:3},children:(0,s.jsx)(h.Z,{component:"div",children:n})})}))}function z(e){return{id:"full-width-tab-".concat(e),"aria-controls":"full-width-tabpanel-".concat(e)}}var F=function(){var e=(0,U.useRouter)(),n=(0,l.useState)(j.O.auth.user()),t=n[0],o=n[1],a=(0,u.Z)(),h=(0,i.Z)(l.useState(0),2),m=h[0],b=h[1];return(0,l.useEffect)((function(){t||(o(null),e.replace("/")),console.log("user",t)}),[t]),(0,s.jsxs)(x.Z,{sx:{bgcolor:"background.paper",minHeight:"100%"},children:[(0,s.jsx)(d.Z,{position:"static",children:(0,s.jsxs)(f.Z,{value:m,onChange:function(e,n){b(n)},textColor:"inherit",variant:"fullWidth","aria-label":"full width tabs example",TabIndicatorProps:{style:{background:"black"}},children:[(0,s.jsx)(p.Z,(0,r.Z)({label:"Send CV"},z(0))),(0,s.jsx)(p.Z,(0,r.Z)({label:"Add CV"},z(1))),(0,s.jsx)(p.Z,(0,r.Z)({label:"My CV's"},z(2)))]})}),(0,s.jsxs)(c.ZP,{axis:"rtl"===a.direction?"x-reverse":"x",index:m,onChangeIndex:function(e){b(e)},style:{height:"100%"},children:[(0,s.jsx)(q,{value:m,index:0,dir:a.direction,children:(0,s.jsx)(V,{user:t})}),(0,s.jsx)(q,{value:m,index:1,dir:a.direction,children:(0,s.jsx)(R,{user:t})}),(0,s.jsx)(q,{value:m,index:2,dir:a.direction,children:(0,s.jsx)(O,{user:t})})]})]})}},3386:function(){}},function(e){e.O(0,[158,183,774,888,179],(function(){return n=7187,e(e.s=n);var n}));var n=e.O();_N_E=n}]);